<?php

class Bewertung {
    private $knid;
    private $note;
    private $comment;

    public function __construct($kneipe) {
        $this->knid = $kneipe;
        $this->load();
    }

    public function getId() {
        return $this->knid;
    }

    public function getNote() {
        return $this->note;
    }

    public function getComment() {
        return $this->comment;
    }

    public static function addBewertung($kid, $note, $comment) {
        $db = Database2::getInstance();        
        $q = $db->q(
            'INSERT INTO %pbewertungen (knid, note, comment) VALUES (%i, %i, %s)
            ON DUPLICATE KEY UPDATE note = %i, comment = %s',
            $kid, $note, $comment, $note, $comment
        );

        return $q->getStatus();
    }

    public function load() {
        $db = Database2::getInstance();
        $q = $db->q('SELECT * FROM %pbewertungen WHERE knid = %i', $this->knid);

        if ($q->hasData()) {
            $this->knid = $q->getFirst()->knid;
            $this->note = $q->getFirst()->note;
            $this->comment = $q->getFirst()->comment;
        }

        return $q->hasData();
    }

    public function remove() {
        // Not implemented
    }
}

?>
